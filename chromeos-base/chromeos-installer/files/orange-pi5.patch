diff --git a/chromeos-install b/chromeos-install
index 3e57814c93..3a41c18d8a 100755
--- a/chromeos-install
+++ b/chromeos-install
@@ -750,6 +750,7 @@ install_stateful() {
     dirlist="${dirlist}
       var_overlay/db/pkg
       var_overlay/lib/portage
+      fyde
       dev_image"

     local metadata_cmd="dlc_metadata_util --metadata_dir=${ROOT}/opt/google/dlc"
@@ -1057,6 +1058,8 @@ do_post_install() {
   fi
   local dst_rootfs_dev=""

+  FLAGS_skip_postinstall="${FLAGS_FALSE}"
+  echo "Ignoring --skip_postinstall"
   # Now run the postinstall script on one new rootfs. Note that even though
   # we're passing the new destination partition number as an arg, the postinst
   # script had better not try to access it, for the reasons we just gave.
diff --git a/chromeos-postinst b/chromeos-postinst
index 180d8a615b..d3fac2a9e7 100755
--- a/chromeos-postinst
+++ b/chromeos-postinst
@@ -37,6 +37,32 @@ cleanup() {
   done
 }

+get_mtd_dev()
+{
+  echo '/dev/mtdblock0'
+}
+
+get_boot_type()
+{
+  cat /mnt/stateful_partition/fyde/Env.txt \
+    | grep -o '^[^#]*' | grep 'overlays=' | grep -q 'ssd-sata'
+
+  if [ "$?" -eq "0" ]; then
+    echo 'SATA'
+    return 0
+  fi
+
+  cat /mnt/stateful_partition/fyde/Env.txt \
+    | grep -o '^[^#]*' | grep 'fdtfile=' | grep -q 'rk3588s-orangepi-5b'
+
+  if [ "$?" -eq "0" ]; then
+    echo 'EMMC'
+  else
+    echo 'NVME'
+  fi
+}
+
+
 main() {
   cd "${INSTALL_ROOT}" || exit 1

@@ -52,6 +78,9 @@ main() {
   fi

   local install_dev="$1"
+
+  chroot . /usr/sbin/flash_spi.sh "$(get_mtd_dev)" "$(get_boot_type)"
+  chroot . /usr/sbin/copy_kernel.sh "$target_disk"
   shift
   chroot . /usr/bin/cros_installer --type="postinst" \
          --install_dev="${install_dev}" --install_dir="/" "$@"
